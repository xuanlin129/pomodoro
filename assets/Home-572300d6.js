import{u as L}from"./list-0d04dc48.js";import{g as W,o as q,a as D,b as j,n as H,u as w,r as b,w as R,c as V,s as M,d as T,e as C,f as N,V as Y,h as A,i as _,t as y,j as I,k as O}from"./index-5400ac9c.js";import{u as $}from"./settings-7850e9ed.js";import{V as U,a as z}from"./VRow-f4096576.js";function E(e){return W()?(q(e),!0):!1}function x(){const e=new Set,n=r=>{e.delete(r)};return{on:r=>{e.add(r);const a=()=>n(r);return E(a),{off:a}},off:n,trigger:r=>Promise.all(Array.from(e).map(a=>a(r)))}}function B(e){return typeof e=="function"?e():w(e)}const J=typeof window<"u",K=()=>{};function Q(e,n=!0){D()?j(e):n?e():H(e)}function X(e){var n;const o=B(e);return(n=o==null?void 0:o.$el)!=null?n:o}const F=J?window:void 0;function Z(...e){let n,o,t,r;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,t,r]=e,n=F):[n,o,t,r]=e,!n)return K;Array.isArray(o)||(o=[o]),Array.isArray(t)||(t=[t]);const a=[],f=()=>{a.forEach(u=>u()),a.length=0},g=(u,s,i,c)=>(u.addEventListener(s,i,c),()=>u.removeEventListener(s,i,c)),p=R(()=>[X(n),B(r)],([u,s])=>{f(),u&&a.push(...o.flatMap(i=>t.map(c=>g(u,i,c,s))))},{immediate:!0,flush:"post"}),d=()=>{p(),f()};return E(d),d}function ee(){const e=b(!1);return D()&&j(()=>{e.value=!0}),e}function te(e){const n=ee();return V(()=>(n.value,!!e()))}function ne(e={}){const{window:n=F}=e,o=te(()=>!!n&&"Notification"in n),t=b(null),r=async()=>{o.value&&"permission"in Notification&&Notification.permission!=="denied"&&await Notification.requestPermission()},{on:a,trigger:f}=x(),{on:g,trigger:p}=x(),{on:d,trigger:u}=x(),{on:s,trigger:i}=x(),c=async m=>{if(!o.value)return;await r();const l=Object.assign({},e,m);return t.value=new Notification(l.title||"",l),t.value.onclick=f,t.value.onshow=p,t.value.onerror=u,t.value.onclose=i,t.value},v=()=>{t.value&&t.value.close(),t.value=null};if(Q(async()=>{o.value&&await r()}),E(v),o.value&&n){const m=n.document;Z(m,"visibilitychange",l=>{l.preventDefault(),m.visibilityState==="visible"&&v()})}return{isSupported:o,notification:t,show:c,close:v,onClick:a,onShow:g,onError:d,onClose:s}}const oe={id:"today",class:"mx-auto d-flex align-center justify-center"},re={id:"doing",class:"mx-auto d-flex flex-column align-center justify-center"},ce={__name:"Home",setup(e){const n=L(),{items:o,currentItem:t,timeleft:r}=M(n),{countdown:a,setCurrentItem:f,setFinishItem:g}=n,p=$(),{selectedAlarmFile:d,notify:u}=M(p),s={STOP:0,COUNTING:1,PAUSE:2},i=b(s.STOP);let c=0;const v=()=>{i.value===s.STOP&&o.value.length>0&&f(),i.value=s.COUNTING,t.value.length!==0&&(c=setInterval(()=>{a(),r.value===0&&l()},1e3))},m=()=>{i.value=s.PAUSE,clearInterval(c)},l=()=>{clearInterval(c),i.value=s.STOP;const h=new Audio;if(h.src=d.value,h.play(),u.value){const{show:S}=ne({title:"事項完成",body:P.value,icon:"https://github.com.wdaweb.png"});S()}g(),o.value.length>0&&v()},P=V(()=>t.value.length>0?t.value:o.value.length>0?"點擊開始":"沒有事項"),G=V(()=>{const h=Math.floor(r.value/60).toString().padStart(2,"0"),S=(r.value%60).toString().padStart(2,"0");return h+":"+S}),k=new Date;return(h,S)=>(T(),C(Y,{class:"h-100 d-flex align-center justify-center"},{default:N(()=>[A(z,{class:"text-center"},{default:N(()=>[A(U,{cols:"12"},{default:N(()=>[_("div",oe," 西元 "+y(w(k).getFullYear())+" 年 "+y(w(k).getMonth()+1)+" 月 "+y(w(k).getDate())+" 日 ",1)]),_:1}),A(U,{cols:"12",class:"mt-5"},{default:N(()=>[_("div",re,[_("h1",null,y(P.value),1),_("h1",null,y(G.value),1),i.value!==s.COUNTING?(T(),C(I,{key:0,variant:"text",icon:"mdi-play",onClick:v})):O("",!0),i.value===s.COUNTING?(T(),C(I,{key:1,variant:"text",icon:"mdi-pause",onClick:m})):O("",!0),w(t).length>0?(T(),C(I,{key:2,variant:"text",icon:"mdi-skip-next",onClick:l})):O("",!0)])]),_:1})]),_:1})]),_:1}))}};export{ce as default};
